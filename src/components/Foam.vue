<template>
  <div class="foam-wrapper">
    <svg
      viewBox="0 0 438 189"
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
    >
      <g id="foam" fill="#FEF4E6" fill-rule="nonzero">
        <path
          d="M313,34.5 C313,24.2827 321.283,16 331.5,16 C341.717,16 350,24.2827 350,34.5 L350,144.5 C350,154.717 341.717,163 331.5,163 C321.283,163 313,154.717 313,144.5 L313,34.5 Z"
          id="foam-1"
        ></path>
        <path
          d="M101,29 C101,19.6112 108.6112,12 118,12 C127.3888,12 135,19.6112 135,29 L135,117 C135,126.389 127.3888,134 118,134 C108.6112,134 101,126.389 101,117 L101,29 Z"
          id="foam-2"
        ></path>
        <path
          d="M289,180.5 C289,175.806 292.806,172 297.5,172 C302.194,172 306,175.806 306,180.5 C306,185.194 302.194,189 297.5,189 C292.806,189 289,185.194 289,180.5 Z"
          id="bubble-2"
        ></path>
        <path
          d="M83,135 C83,131.686 85.6863,129 89,129 C92.3137,129 95,131.686 95,135 C95,138.314 92.3137,141 89,141 C85.6863,141 83,138.314 83,135 Z"
          id="bubble-1"
        ></path>
        <g id="foam-group" transform="translate(0.000000, 5.000000)">
          <path
            d="M401.834,41 C401.834,30.7827 410.117,22.5 420.334,22.5 C430.552,22.5 437.088,30.7827 437.088,41 L437.088,94.0299 C437.088,104.247 430.552,112.53 420.334,112.53 C410.117,112.53 401.834,104.247 401.834,94.0299 L401.834,41 Z"
            id="Path"
          ></path>
          <path
            d="M370,35.5 C370,25.2827 378.283,17 388.5,17 C398.718,17 405.254,25.2827 405.254,35.5 L405.254,88.5299 C405.254,98.747 398.718,107.03 388.5,107.03 C378.283,107.03 370,98.747 370,88.5299 L370,35.5 Z"
            id="Path-Copy"
          ></path>
          <path
            d="M250.834,71.5299 C250.834,59.932 260.236,50.5299 271.834,50.5299 C283.432,50.5299 292.834,59.932 292.834,71.5299 L292.834,78.5299 C292.834,90.1279 283.432,99.53 271.834,99.53 C260.236,99.53 250.834,90.1279 250.834,78.5299 L250.834,71.5299 Z"
            id="Path"
          ></path>
          <path
            d="M208.578021,35.5339243 C221.419021,27.1362243 238.636021,30.7377243 247.033021,43.5782243 L251.636021,50.6163243 C260.034021,63.4568243 256.432021,80.6737243 243.592021,89.0714243 C230.751021,97.4689243 213.535021,93.8676243 205.137021,81.0271243 L200.534021,73.9890243 C192.136021,61.1485243 195.738021,43.9316243 208.578021,35.5339243 Z"
            id="Path"
          ></path>
          <path
            d="M0,27.9999641 C0,12.5360506 11.8643984,0 26.500011,0 C41.1355133,0 53,12.5360506 53,27.9999641 L53,62.9999192 C53,78.4638327 41.1355133,91 26.500011,91 C11.8643984,91 0,78.4638327 0,62.9999192 L0,27.9999641 Z"
            id="Path"
          ></path>
          <path
            d="M94.8342,69.5299 C94.8342,82.7848 84.0891,93.5299 70.8342,93.5299 C57.5794,93.5299 46.8342,82.7848 46.8342,69.5299 C46.8342,56.2751 57.5794,45.5299 70.8342,45.5299 C84.0891,45.5299 94.8342,56.2751 94.8342,69.5299 Z"
            id="Path"
          ></path>
          <path
            d="M329.834,89.0299 C329.834,99.799 321.104,108.53 310.334,108.53 C299.565,108.53 290.834,99.799 290.834,89.0299 C290.834,78.2604 299.565,69.5299 310.334,69.5299 C321.104,69.5299 329.834,78.2604 329.834,89.0299 Z"
            id="Path"
          ></path>
          <path
            d="M165.3123,103.37936 C202.4753,97.90776 231.0003,65.88716 231.0003,27.20416 C231.0003,21.94126 230.4723,16.80156 229.4663,11.83536 L79.9565,6 C78.031,12.73616 77,19.84976 77,27.20416 C77,63.79926 114.420892,97.3112255 136.7493,102.26436 C143.561648,103.962398 153.082648,104.334064 165.3123,103.37936 Z"
            id="Path"
          ></path>
          <path
            d="M411.834,74.5299 C411.834,90.5462 391.463,103.53 366.334,103.53 C341.205,103.53 320.834,90.5462 320.834,74.5299 C320.834,58.5137 341.205,45.5299 366.334,45.5299 C391.463,45.5299 411.834,58.5137 411.834,74.5299 Z"
            id="Path"
          ></path>
        </g>
        <path
          d="M0.0320114,39.6798 C0.896937,17.5194 19.1133,0 41.2906,0 L389.014,0 C415.564,0 437.088,21.5231 437.088,48.0733 C437.088,75.3589 414.404,97.1743 387.139,96.1102 L39.6803,82.5488 C16.8938,81.6595 -0.857349,62.4664 0.0320114,39.6798 Z"
          id="main-foam"
        ></path>
      </g>
    </svg>
  </div>
</template>

<script>
import { gsap } from 'gsap';
export default {
  name: 'Foam',
  data() {
    return {
      tl: new gsap.timeline({ paused: true }),
      defaultPosition: true,
    };
  },
  computed: {
    count() {
      return this.$store.state.count;
    },
  },
  watch: {
    // foam animation
    count(value) {
      const delay = 0.5;
      this.tl.fromTo(
        '#foam-1',
        { y: -40, autoAlpha: 0 },
        { y: 25, autoAlpha: 1, duration: 0.7 },
        delay - 0.3,
      );
      this.tl.fromTo(
        '#foam-2',
        { y: -40, autoAlpha: 0 },
        { y: 25, autoAlpha: 1, duration: 0.7 },
        delay - 0.2,
      );
      this.tl.fromTo(
        '#bubble-1',
        { y: 10, autoAlpha: 0 },
        { y: 25, autoAlpha: 1, duration: 0.7 },
        delay,
      );
      this.tl.fromTo(
        '#bubble-2',
        { y: -30, autoAlpha: 0 },
        { y: 0, autoAlpha: 1, duration: 1 },
        delay,
      );
      this.tl.fromTo(
        '#main-foam',
        { y: -10, autoAlpha: 0 },
        { y: 25, autoAlpha: 1, duration: 0.2 },
        delay + 0.1,
      );
      this.tl.fromTo(
        '#foam-group path',
        { y: 0, autoAlpha: 0 },
        { y: 25, autoAlpha: 1, stagger: 0.01, duration: 0.2 },
        delay,
      );
      if (value === 10) {
        this.tl.timeScale(1);
        this.tl.restart();
        this.defaultPosition = false;
      } else {
        if (!this.defaultPosition) {
          this.tl.timeScale(3);
          this.tl.reverse();
        }
      }
    },
  },
};
</script>

<style lang="scss" scoped>
.foam-wrapper {
  position: absolute;
  z-index: -1;
  top: -100px;
  left: -50px;
  path {
    opacity: 0;
    visibility: 0;
  }
  svg {
    width: 480px;
  }
}
</style>
